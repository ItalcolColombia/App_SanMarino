<!-- Modal de Registro Inicial de Producci√≥n -->
<div *ngIf="isOpen" class="ux-modal" role="dialog" aria-modal="true" aria-labelledby="registro-inicial-modal-title">
  <div class="ux-modal__dialog">
    <header class="ux-modal__header">
      <h2 id="registro-inicial-modal-title">Registro Inicial de Producci√≥n</h2>
      <button type="button" class="icon-btn" (click)="onClose()" aria-label="Cerrar">‚úï</button>
    </header>

    <!-- Informaci√≥n del lote -->
    <div class="modal-lote-info">
      <div class="info-card">
        <strong>Lote:</strong> {{ loteNombre || '‚Äî' }}
      </div>
      <div class="info-card" *ngIf="nucleoAsignado">
        <strong>N√∫cleo Actual:</strong> {{ nucleoAsignado }}
      </div>
    </div>

    <form [formGroup]="form" (ngSubmit)="onSave()" class="ux-form" novalidate>
      <div class="ux-tabs" role="tablist" aria-label="Secciones del registro inicial">
        <input type="radio" name="regTab" id="tab-general" checked />
        <label class="ux-tab" id="lab-general" for="tab-general" role="tab" tabindex="0" aria-controls="panel-general" aria-selected="true">General</label>

        <input type="radio" name="regTab" id="tab-aves" />
        <label class="ux-tab" id="lab-aves" for="tab-aves" role="tab" tabindex="0" aria-controls="panel-aves" aria-selected="false">Aves Iniciales</label>

        <div class="ux-tab-panels">
          <!-- GENERAL -->
          <section id="panel-general" class="ux-tab-panel" role="tabpanel" aria-labelledby="lab-general">
            <div class="grid grid-2">
              <div class="form-field">
                <label for="f-fecha-inicio">Fecha de Inicio</label>
                <input id="f-fecha-inicio" type="date" formControlName="fechaInicio" />
                <small class="ux-hint">Fecha cuando comenz√≥ la producci√≥n</small>
              </div>

              <div class="form-field">
                <label for="f-lote-id">Lote ID</label>
                <input id="f-lote-id" type="number" formControlName="loteId" readonly class="ux-input--readonly" />
                <small class="ux-hint">ID del lote seleccionado</small>
              </div>

              <div class="form-field">
                <label for="f-tipo-nido">Tipo de Nido</label>
                <select id="f-tipo-nido" formControlName="tipoNido">
                  <option value="Manual">Manual</option>
                  <option value="Jansen">Jansen</option>
                  <option value="Vencomatic">Vencomatic</option>
                </select>
                <small class="ux-hint">Seleccione el tipo de nido</small>
              </div>

              <div class="form-field">
                <label for="f-ciclo">Ciclo</label>
                <select id="f-ciclo" formControlName="ciclo">
                  <option value="normal">Normal</option>
                  <option value="2 Replume">2 Replume</option>
                  <option value="D: Depopulaci√≥n">D: Depopulaci√≥n</option>
                </select>
                <small class="ux-hint">Tipo de ciclo de producci√≥n</small>
              </div>

              <div class="form-field form-field--full">
                <label for="f-nucleo-p">N√∫cleo de Producci√≥n (NucleoP)</label>
                <input id="f-nucleo-p" type="text" formControlName="nucleoP" placeholder="Ingrese el n√∫cleo de producci√≥n (semana 26)" />
                <small class="ux-hint">N√∫cleo de producci√≥n correspondiente al cierre de semana 25 (semana 26)</small>
              </div>
            </div>
          </section>

          <!-- AVES INICIALES -->
          <section id="panel-aves" class="ux-tab-panel" role="tabpanel" aria-labelledby="lab-aves">
            <div class="grid grid-2">
              <div class="form-field">
                <label for="f-aves-h">Aves Iniciales Hembras</label>
                <input id="f-aves-h" type="number" min="0" formControlName="avesInicialesH" placeholder="0" />
                <small class="ux-hint">N√∫mero total de hembras al inicio</small>
              </div>

              <div class="form-field">
                <label for="f-aves-m">Aves Iniciales Machos</label>
                <input id="f-aves-m" type="number" min="0" formControlName="avesInicialesM" placeholder="0" />
                <small class="ux-hint">N√∫mero total de machos al inicio</small>
              </div>

              <div class="form-field">
                <label for="f-huevos">Huevos Iniciales</label>
                <input id="f-huevos" type="number" min="0" formControlName="huevosIniciales" placeholder="0" />
                <small class="ux-hint">Huevos contados al inicio de producci√≥n</small>
              </div>

              <div class="form-field form-field--full">
                <div class="resumen-card">
                  <div class="resumen-icon">üêî</div>
                  <div class="resumen-content">
                    <h4>Total de Aves</h4>
                    <p class="resumen-number">{{ getTotalAves() }}</p>
                  </div>
                </div>
              </div>
            </div>
          </section>
        </div>
      </div>

      <footer class="ux-modal__footer">
        <button type="button" class="btn btn--ghost" (click)="onClose()">Cancelar</button>
        <button type="submit" class="btn btn--primary" [disabled]="loading || form.invalid">
          {{ loading ? 'Guardando‚Ä¶' : 'Guardar Registro Inicial' }}
        </button>
      </footer>
    </form>

    <div *ngIf="loading" class="modal-loading" role="status" aria-live="polite">
      <div class="spinner"></div> Guardando‚Ä¶
    </div>
  </div>
</div>



