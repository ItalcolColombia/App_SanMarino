<!-- src/app/features/inventario/components/kardex-list/kardex-list.component.html -->
<div class="kardex-container">
  <!-- Filtros -->
  <div class="filters">
    <div class="filter">
      <label class="ux-label" for="farm">Granja *</label>
      <select id="farm" class="ux-select" [(ngModel)]="farmId" (change)="load()">
        <option [ngValue]="null" disabled>Seleccioneâ€¦</option>
        <option *ngFor="let f of farms" [ngValue]="f.id">{{ f.name }}</option>
      </select>
    </div>

    <div class="filter">
      <label class="ux-label" for="item">Producto *</label>
      <select id="item" class="ux-select" [(ngModel)]="itemId" (change)="load()">
        <option [ngValue]="null" disabled>Seleccioneâ€¦</option>
        <option *ngFor="let it of items" [ngValue]="it.id">{{ it.codigo }} â€” {{ it.nombre }}</option>
      </select>
    </div>

    <div class="filter">
      <label class="ux-label" for="desde">Desde</label>
      <input id="desde" type="date" class="ux-input" [(ngModel)]="desde" (change)="load()" />
    </div>

    <div class="filter">
      <label class="ux-label" for="hasta">Hasta</label>
      <input id="hasta" type="date" class="ux-input" [(ngModel)]="hasta" (change)="load()" />
    </div>
  </div>

  <!-- Tabla de Kardex -->
  <div class="kardex-card" [class.is-loading]="loading">
    <div class="kardex-header" *ngIf="kardex.length > 0">
      <h3 class="kardex-title">Historial de Movimientos</h3>
      <span class="kardex-count">{{ kardex.length }} movimiento(s)</span>
    </div>
    <div class="ux-scroll">
      <table class="ux-table">
        <thead>
          <tr>
            <th>Fecha</th>
            <th>Tipo</th>
            <th>Referencia</th>
            <th class="text-right">Cantidad</th>
            <th>Unidad</th>
            <th class="text-right">Saldo</th>
            <th>Motivo</th>
          </tr>
        </thead>
        <tbody *ngIf="!loading && kardex.length === 0">
          <tr>
            <td colspan="7" class="empty-state">
              <div class="empty-content">
                <span class="empty-icon">ðŸ“‹</span>
                <p>No hay movimientos para mostrar</p>
                <p class="empty-hint">Seleccione una granja y un producto para consultar el historial</p>
              </div>
            </td>
          </tr>
        </tbody>
        <tbody *ngIf="!loading && kardex.length > 0">
          <tr *ngFor="let k of kardex; trackBy: trackByDate">
            <td class="kardex-date">{{ k.fecha | date:'short' }}</td>
            <td>
              <span class="kardex-type-badge" [class]="getTypeClass(k.tipo)">
                {{ translateMovementType(k.tipo) }}
              </span>
            </td>
            <td>{{ k.referencia || 'â€“' }}</td>
            <td class="text-right" [class]="signClass(k.cantidad)">
              <span class="quantity-display">
                {{ k.cantidad > 0 ? '+' : '' }}{{ k.cantidad | number:'1.0-3' }}
              </span>
            </td>
            <td>{{ k.unidad }}</td>
            <td class="text-right">
              <strong class="balance-display">{{ k.saldo | number:'1.0-3' }}</strong>
            </td>
            <td>{{ k.motivo || 'â€“' }}</td>
          </tr>
        </tbody>
      </table>
    </div>
    <div *ngIf="loading" class="loading-overlay">
      <div class="spinner"></div>
      <span>Cargando historialâ€¦</span>
    </div>
  </div>
</div>
