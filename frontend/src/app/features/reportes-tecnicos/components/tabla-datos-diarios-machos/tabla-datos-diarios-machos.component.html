<div class="tabla-container">
  <!-- Encabezado del Reporte (similar a la imagen) -->
  <div class="reporte-encabezado" *ngIf="informacionLote">
    <div class="encabezado-info">
      <div class="info-row">
        <span class="info-label">SANMARINO</span>
        <span class="info-separator">|</span>
        <span class="info-value">Línea: {{ informacionLote.linea || 'N/A' }}</span>
        <span class="info-separator">|</span>
        <span class="info-value">Raza: {{ informacionLote.raza || 'N/A' }}</span>
        <span class="info-separator">|</span>
        <span class="info-value">Etapa: LEVANTE</span>
      </div>
      <div class="info-row">
        <span class="info-label">REPORTE DIARIO MACHOS</span>
        <span class="info-separator">|</span>
        <span class="info-value" *ngIf="informacionLote.granjaNombre">{{ informacionLote.granjaNombre }}</span>
        <span class="info-separator" *ngIf="informacionLote.granjaNombre">|</span>
        <span class="info-value">Número de Machos: {{ informacionLote.numeroMachos || 0 }}</span>
        <span class="info-separator">|</span>
        <span class="info-value" *ngIf="informacionLote.fechaEncaset">
          Encaset: {{ formatDate(informacionLote.fechaEncaset) }}
        </span>
        <span class="info-separator" *ngIf="informacionLote.galpon">|</span>
        <span class="info-value" *ngIf="informacionLote.galpon">Galpón: {{ informacionLote.galpon }}</span>
        <span class="info-separator" *ngIf="informacionLote.loteNombre">|</span>
        <span class="info-value" *ngIf="informacionLote.loteNombre">Lote: {{ informacionLote.loteNombre }}</span>
      </div>
    </div>
  </div>

  <div class="table-responsive">
    <table class="tabla-datos">
      <thead>
        <tr>
          <th rowspan="2">FECHA DIARIA</th>
          <th rowspan="2">EDAD EN SEM.</th>
          <th rowspan="2">Nro. Aves Diario</th>
          <th colspan="3">MORTALIDAD</th>
          <th colspan="3">ERRORES DE SEXAJE</th>
          <th colspan="3">DESCARTES</th>
          <th colspan="4">CONSUMIDO ALIMENTO</th>
          <th colspan="4">PESO CORPORAL Grs.</th>
          <th rowspan="2">INGRESOS ALIMENTO</th>
          <th rowspan="2">TRASLADOS ALIMENTO</th>
          <th rowspan="2">SELECCIÓN VENTAS</th>
        </tr>
        <tr>
          <!-- Mortalidad -->
          <th>TOTAL DIARIO</th>
          <th>% MORT. DIARIA</th>
          <th>% MORT. ACUM.</th>
          <!-- Errores de Sexaje -->
          <th>No. AVES</th>
          <th>%</th>
          <th>% ACUM.</th>
          <!-- Descarte -->
          <th>No. AVES</th>
          <th>% DIA</th>
          <th>% ACUM.</th>
          <!-- Consumido Alimento -->
          <th>CONSUMO BULTO</th>
          <th>CONSUMO KILOS</th>
          <th>ACUM KILOS</th>
          <th>GRAM. AVE</th>
          <!-- Peso Corporal -->
          <th>ACTUAL</th>
          <th>UNIFOR.</th>
          <th>GANAN</th>
          <th>COEF.V</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let dato of datos; trackBy: trackByFecha">
          <!-- Fecha Diaria -->
          <td class="text-left">{{ formatDate(dato.fecha) }}</td>
          
          <!-- Edad en Semanas -->
          <td>{{ dato.edadSemanas }}</td>
          
          <!-- Nro. Aves Diario (Saldo Machos) -->
          <td class="text-right"><strong>{{ dato.saldoMachos }}</strong></td>
          
          <!-- Mortalidad -->
          <td [class]="getMortalidadClass(dato.mortalidadMachos)" class="text-right">
            {{ dato.mortalidadMachos }}
          </td>
          <td [class]="getPorcentajeClass(dato.mortalidadMachosPorcentajeDiario)" class="text-right">
            {{ formatNumber(dato.mortalidadMachosPorcentajeDiario) }}%
          </td>
          <td class="text-right">{{ formatNumber(dato.mortalidadMachosPorcentajeAcumulado) }}%</td>
          
          <!-- Errores de Sexaje -->
          <td class="text-right">{{ dato.errorSexajeMachos }}</td>
          <td class="text-right">{{ formatNumber(dato.errorSexajeMachosPorcentajeDiario) }}%</td>
          <td class="text-right">{{ formatNumber(dato.errorSexajeMachosPorcentajeAcumulado) }}%</td>
          
          <!-- Descarte (Selección Machos) -->
          <td class="text-right">{{ dato.seleccionMachos }}</td>
          <td class="text-right">{{ formatNumber(dato.seleccionMachosPorcentajeDiario) }}%</td>
          <td class="text-right">{{ formatNumber(dato.seleccionMachosPorcentajeAcumulado) }}%</td>
          
          <!-- Consumido Alimento -->
          <td class="text-right">{{ formatNumber(calcularConsumoBultos(dato.consumoKgMachos), 3) }}</td>
          <td class="text-right">{{ formatNumber(dato.consumoKgMachos, 1) }}</td>
          <td class="text-right">{{ formatNumber(dato.consumoKgMachosAcumulado, 1) }}</td>
          <td class="text-right">{{ formatNumber(dato.consumoGramosPorAveMachos, 2) }}</td>
          
          <!-- Peso Corporal -->
          <td class="text-right">{{ formatNumber(dato.pesoPromedioMachos ? dato.pesoPromedioMachos * 1000 : null, 1) }}</td>
          <td class="text-right">{{ formatNumber(dato.uniformidadMachos, 1) }}</td>
          <td class="text-right">{{ formatNumber(dato.gananciaPesoMachos ? dato.gananciaPesoMachos * 1000 : null, 1) }}</td>
          <td class="text-right">{{ formatNumber(dato.coeficienteVariacionMachos, 1) }}</td>
          
          <!-- Ingresos Alimento -->
          <td class="text-right">{{ formatNumber(dato.ingresosAlimentoKilos, 1) }}</td>
          
          <!-- Traslados Alimento -->
          <td class="text-right">{{ formatNumber(dato.trasladosAlimentoKilos, 1) }}</td>
          
          <!-- Selección Ventas (Selección Machos) -->
          <td class="text-right">{{ dato.seleccionMachos }}</td>
        </tr>
      </tbody>
    </table>
  </div>
</div>
